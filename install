#!/usr/bin/env bash
set -e
set -o errexit
set -o nounset
set -o pipefail
D_DEBUG=false
ARGS=""
if [[ $# -gt 0 ]]; then
    [[ "$*" == *"-go"* ]] && IGO=true || true
    [[ "$*" == *"-aws"* ]] && IAWS=true || true
    [[ "$*" == *"-tf"* ]] && ITF=true || true
    [[ "$*" == *"-docker"* ]] && IDOCKER=true || true
    [[ "$*" == *"-code"* ]] && ICODESERVER=true || true
    [[ "$*" == *"-d "* ]] && D_DEBUG=true || true
    [[ "$*" == *"-test"* ]] && echo -n "$*"; exit 0 || true
fi

source scripts/functions
source bash_inc
unset_d

BASEDIR=$(dirname $0)
cd $BASEDIR

echo "Starting script"
echo "Running check_prereqs"
check_prereqs
install_bash_inc
install_bash_rc
checkVersions
[[ $IGO == true ]] && install_go || true
[[ $IGO == true ]] && install_go_tools || true
[[ $IAWS == true ]] && install_aws || true
[[ $ITF == true ]] && install_terraform || true
[[ $IDOCKER = true ]] &% install_docker || true
[[ $IDC == true ]] && install_docker_compose || true
[[ $ICODESERVER = true ]] &% install_code_server || true


ln -s ${PWD}/terraformrc ~/.terraformrc











